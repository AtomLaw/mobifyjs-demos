{>"/base/lib/base_konf.konf"/}
{<konf} {

'header': {
    // Cart
	'cartLink': function() {
		return $('a.top-link-cart').attr('href');
	}
	, 'cartValue': function() {
		return $('a.top-link-cart span').text();
	}
	
	// Expandable Menu Navigation
	, 'dropdownNav': function() {
		return $('#nav');
	}

	// Search Form	
	, 'search': function() {
		$('#search_mini_form input#search').attr('placeholder', 'Search entire store here...');
		return $('#search_mini_form');
	}
},

'footer': {

	// Text Banner Block
	'bannerText': function() {
		return $('.top-container li p');
	}
	
	// Click-to-Call Block
	, 'phone': function() {
		return $('.nav-container .call span').text();
	}
	
	// Footer Navigation
	, 'aboutLink': function() {
		return $('.footer a.about');
	}
	, 'contactLink': function() {
		return $('.footer a[title="Contact Us"]');
	}
	, 'termsLink': function() {
		return $('.footer a[title="Terms of Use"]');
	}
	, 'copyright': function() {
		return $('.footer address');
	}
},

'content': function(context) {
    return context.choose(
        {
            'templateName': 'home'

            // Random Grid Hero Image Layout
            , '!gridHero': function() {
            
                var heroElems = $('#hero a');
                
                shuffle = function(o) { // Pick a random hero order (http://stackoverflow.com/a/5991990)
                    var j, x, i = o.length; 
                    while (i) {
                       j = parseInt(Math.random() * i);
                       x = o[--i];
                       o[i] = o[j];
                       o[j] = x;
                    }
                }

                shuffled = shuffle(heroElems);
                
                return heroElems;
            }
            
            // Image Slider
            , 'sliderHero': function(context) {
                context.data('gridHero', ''); // Don't render gridHero if this is visible
                return $('#hero a');
            }

            // Accordion Menu Category Selection
            , 'accordionCategories': function() {
                return $('#categories');
            }
            
            // Grid-based Category Selection
            , 'gridCategories': function(context) {
                context.data('accordionCategories', ''); // Don't render accordionCategories if this is visible
                
                return $('#categories .block-title');
            }
            
            // Newsletter Block ///////////
            , 'newsletterSignup': function() {
                return $('.form-subscribe');
            }
            // Poll Block
            , 'poll': function() {
                return $('.block-poll');
            }
        },{
             // @url /magento/index.php/products/
             // Renders the products template if $('.category-products') evaluates. 
            templateName: 'products'

            // extract the products div from the products page
            , '!products': function() { 
                var products = $('.category-products'); 
                products.find('.limiter, .view-mode').remove();
                return products;
            }

        },{
            // @url /magento/index.php/first-potion.html
            // Renders the product template if the following required variables evaluate to truthy
            templateName: 'product'

            // extract the product view div from the product page
            , '!product': function() { 
                var productView = $('.product-view');
                // remove zoom div
                $('.zoom', productView).remove();
                // remove zoom p
                $('.zoom-notice', productView).remove();
                // remove tagging functionality for logged in customers
                $('.box-tags', productView).remove();

                return productView;

            }

            , '?breadcrumbs': function() { 
                return $('.breadcrumbs'); 
            }
        },{
            templateName: 'cart'
            // Extract the cart div.
            , '!is_cart': function() {
                return $('.checkout-cart-index');
            }
            , 'cart' : function() { 
                return $('.cart');
            }
        
        },{
            templateName: 'checkout'
            // Extract the checkout div
            , '!checkout' : function() { 
                return $('#checkoutSteps'); 
            }
        },{
            templateName: 'about'
            // Extract the about us div
            , '!about' : function() { 
                return $('#about-us'); 
            }
        },{
            templateName: 'customer'
            // Extract the customer service div
            , '!customerservice': function() { 
                return $('#customer-service');
            }
        },{
            templateName: 'contact'
            // Extract the contact form
            , '!contactform': function() { 
                return $('#contactForm'); 
            }
        },{
            templateName: 'login'
            , '!login': function() { 
                // Extract the account login div.
                var loginDiv = $('.account-login'); 
                // Remove the registration div, because we're not demostrating a registration here
                $('.new-users', loginDiv).remove();
                $('.page-title', loginDiv).remove();

                return loginDiv;
            }
        },{
            templateName: 'account'
            , '!account': function() {
                return $('.dashboard .welcome-msg');
            }
        }
    )
}

, 'script': function() {
    return $('script').remove();
}

, 'stylesheet': function() {
    return $('link[rel="stylesheet"]').remove();
}

, 'OUTPUTHTML': function(context) {
    var templateName = context.data('content.templateName');
    if (templateName) {
        return context.tmpl(templateName);
    }
}

} {/konf}
